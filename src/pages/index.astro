---
import BaseLayout from '../layouts/BaseLayout.astro';
import PostRow from '../components/blog/PostRow.svelte';
import { getCollection } from 'astro:content';

// Get all posts, filter out drafts, and sort by date
const posts = (await getCollection('posts'))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, 10); // Show latest 10 posts on homepage
---

<BaseLayout>
  <!-- Hero Section -->
  <section class="py-20 sm:py-28">
    <div class="container mx-auto px-4 max-w-3xl text-center">
      <!-- Avatar with hover reveal effect -->
      <div class="group relative inline-block mb-8 animate-fade-in-up cursor-pointer">
        <div class="absolute inset-0 rounded-full bg-foreground/5 dark:bg-white/10 blur-2xl scale-150 transition-opacity duration-500 group-hover:opacity-70"></div>
        <!-- Blur image (default, grayscale) -->
        <img
          src="/images/image_blur.webp"
          alt="Hido"
          class="relative w-32 h-32 sm:w-36 sm:h-36 rounded-full object-cover ring-2 ring-border
                 grayscale transition-all duration-500 ease-out
                 group-hover:opacity-0 group-hover:scale-105"
        />
        <!-- Clear image (on hover, color) -->
        <img
          src="/images/image_clear.webp"
          alt="Hido"
          class="absolute inset-0 w-32 h-32 sm:w-36 sm:h-36 rounded-full object-cover ring-2 ring-border
                 opacity-0 scale-95 transition-all duration-500 ease-out
                 group-hover:opacity-100 group-hover:scale-100"
        />
      </div>

      <!-- Hero statement -->
      <h1 class="text-3xl sm:text-4xl md:text-5xl leading-tight mb-6 animate-fade-in-up animate-delay-100">
        <span class="font-bold text-foreground">I'm Hido,</span>
        <span class="font-normal text-muted-foreground"> exploring ideas at the intersection of AI, data, and human behavior.</span>
      </h1>

      <!-- Role descriptors -->
      <p class="text-muted-foreground text-lg animate-fade-in-up animate-delay-200">
        AI & Data Product Manager
      </p>
    </div>
  </section>

  <!-- Posts Section -->
  <section class="pb-20">
    <div class="container mx-auto px-4 max-w-5xl mb-8">
      <div class="flex items-center justify-between">
        <h2 class="text-sm font-semibold uppercase tracking-widest text-muted-foreground">
          Recent Posts
        </h2>
        <a
          href="/posts"
          class="text-sm text-muted-foreground hover:text-foreground transition-colors duration-200 inline-flex items-center gap-1"
        >
          View all
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M5 12h14"></path>
            <path d="m12 5 7 7-7 7"></path>
          </svg>
        </a>
      </div>
    </div>

    <div class="space-y-1">
      {posts.map((post) => (
        <PostRow
          client:load
          title={post.data.title}
          date={post.data.date}
          slug={post.id}
        />
      ))}
    </div>
  </section>
</BaseLayout>
